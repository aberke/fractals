<!doctype html>
<html>
<head>
	<title>Fractals</title>

	<meta name="description" content="Animated fractals drawn in javascript: The Sierpiński Triangle & The Sierpiński Arrowhead Curve & some Pythagoras Trees">
	<meta name="author" content="Alex Berke | aberke">

	<link rel="shortcut icon" href="img/sierpinski-triangle.png" type="image/x-icon">
	<meta property="og:image" content="https://aberke.github.io/fractals/img/pascal-tree-1.gif" />

	<script type="text/javascript" src="js/raphael/raphael.js"></script>

	<script type="text/javascript" src="js/util.js"></script>
	<script type="text/javascript" src="js/pythagoras-tree.js"></script>
	<script type="text/javascript" src="js/sierpinski-triangle.js"></script>
	<script type="text/javascript" src="js/sierpinski-arrowhead-curve.js"></script>


	<link rel="stylesheet" href="css/fractals.css">
	<!-- Google fonts -->
	<link href="https://fonts.googleapis.com/css?family=Raleway:400,400i,500,600,700,800" rel="stylesheet">

</head>
<body>

<div id="main-container">

	<h1>Fractals</h1>

	<div id="main-description" class="description">
		<p>Fractals are patterns that are generated by repeating themselves.</p>
		<br/>
		<p>They are <a target="_blank" href="https://en.wikipedia.org/wiki/Recursion" class="bold">recursive</a>: <br/>They start with a simple rule that is replicated at every level of the fractal. <br/>Fractals can be infinitely complex, yet created from a simple rule.</p>
	</div>


	<section id="sierpinski-triangle" class="fractal-section">
		<h2>Sierpiński Triangle</h2>

		<div id="canvas-1" class="canvas"></div>
		<button class="redraw-btn" id="sierpinski-triangle-redraw-btn">Redraw</button>

		<p>The Sierpiński Triangle can be generated by following the rule that every triangle has a smaller triangle drawn on each of its sides.</p>
		<p>At each level, triangles are drawn with half the side length of the triangles drawn at the previous level.</p>
		<br/>
		<a href="https://github.com/aberke/fractals/blob/master/js/sierpinski-triangle.js" class="code-link">See the code that made this.</a>
		<br/>
		<p>Another fractal that draws along the outline of the Sierpiński Triangle is the Sierpiński Arrowhead Curve</p>

	</section>


	<section id="sierpinski-arrowhead-curve" class="fractal-section">
		<h2>Sierpiński Arrowhead Curve</h2>

		<div id="canvas-2" class="canvas"></div>
		<button class="redraw-btn" id="sierpinski-arrowhead-curve-redraw-btn">Redraw</button>

		<p>The Sierpiński Arrowhead Curve is created by a series of 60&deg; turns.  At each level, a line that would be drawn is replaced by 3 lines at 60&deg; angles to each other.  Although these 3 lines turn, they end where the original line would have ended. Each level is drawn with lines half the length of the previous level's lines.</p>
		<br/>
		<p>The curve can be drawn with 2 substitution rules:
		<br/>
		A → B-A-B
		<br/>
		B → A+B+A
		<br/>
		<br/>
		A and B are functions that call each other recursively until the number of calls reaches the number of levels, at which point a line is drawn.
		<br/>
		+ means "turn left 60&deg;", and − means "turn right 60&deg;".
		</p>
		<br/>
		<br/>
		<p>More formally, the curve can be defined with a <a target="_blank" href="http://mathworld.wolfram.com/StringRewritingSystem.html">rewrite system</a>.</p>
		<br/>
		<a href="https://github.com/aberke/fractals/blob/master/js/sierpinski-arrowhead-curve.js" class="code-link">See the code that made this.</a>

	</section>

	<section class="fractal-section">
		<h2>Pythagoras Tree</h2>
		<div id="canvas-3" class="canvas">
			<!-- Update the 'Level' number as the tree grows in animation -->
			<p class="level-text-p">Level: <span class="level-text"></span></p>
			<button class="redraw-btn">Redraw</button>
		</div>
		<p>The Pythagoras Tree is a fractal created by squares.  Each level of squares has 2 smaller squares on the following level with which it encloses a 45&deg;-45&deg;-90&deg; triangle.  It is because of these right triangles that the fractal was named after Pythagoras.
		<br/>
		<br/>
		The rule to generate each new level is to take each square at the preceding level, scale down its side length by ½√2 and create 2 new squares of that smaller size at its top left and right corners that meet at a 90&deg; angle.

		<br/>
		Each level will then have 2 times as many squares as the previous level, and each level's squares will have side lengths that are ½√2 times the size of the previous level's.
		<br/>
		<br/>
		<a href="https://github.com/aberke/fractals/blob/master/js/pythagoras-tree.js" class="code-link">See the code that made this.</a>
		<br/>
		Now consider a Pythagoras Tree where the lines that make up the squares of the tree are not lines, but replaced with other edges.  These edges may curve, but they still end up at the same corners the square's lines would have ended.
		<br/>
		I drew some for you.
		</p>

		<div id="canvas-4" class="canvas">
			<!-- Update the 'Level' number as the tree grows in animation -->
			<p class="level-text-p">Level: <span class="level-text"></span></p>
			<button class="redraw-btn">Redraw</button>
		</div>
		<p>
		The rules that generated these trees were exactly the same, except instead of squares building the tree, other shapes built the tree.
		</p>
		<br/>
		<p>
		Another way to think of the tree is as an acyclic directed graph, where each square is a node with two child node squares that have side lengths of ½√2 its own side length.
		</p>
	</section>
</div>

<footer>

	<p>Made with &#9825; in NYC by <a href="http://aberke.com" target="_blank">Alex Berke</a></p>
	<br/>
	<a target="_blank" href="https://github.com/aberke/fractals">Check it out on Github</a>
	<br/>
	<br/>
	<p>Why did you make this?  <br/>I love fractals.  I also love math and am working on a coloring book that teaches its audience <a target="_blank" href="https://en.wikipedia.org/wiki/Group_theory">group theory</a>, and needed to draw some fractals in javascript.  It was harder than I thought, and led down a rabbit hole that seemed worthy of a webpage.  I wanted to be able to share the javascript code I wrote so that others did not later have the same troubles as I.</p>

</footer>

<script>
"use strict";


// draw a row of triangles

// how many drawings in a row
const TRIANGLE_ROW_COUNT = 5;

const TRIANGLE_CANVAS_HEIGHT = 300; // deal with mobile case later

var paper1 = new Raphael("canvas-1", "100%", TRIANGLE_CANVAS_HEIGHT);
var paper2 = new Raphael("canvas-2", "100%", TRIANGLE_CANVAS_HEIGHT);

let maxOrder = 6;
let baseFractalFunction = getSierpinskiTriangle;

// draw the Sierpinski Triangle with a 'redraw button'
var redrawSierpinskiTriangleFractals = function() {
	paper1.clear();
	let sierpinskiTriangleFractals = drawFractalRow(paper1, TRIANGLE_ROW_COUNT, maxOrder, getSierpinskiTriangle, baseFractalFunction);
}
var redrawSierpinskiTriangleFractalsButton = document.getElementById("sierpinski-triangle-redraw-btn");
redrawSierpinskiTriangleFractalsButton.onclick = redrawSierpinskiTriangleFractals;
redrawSierpinskiTriangleFractals();


// draw the arrow head curves with a 'redraw' button
var redrawSierpinskiArrowheadCurveFractals = function() {
	paper2.clear();
	let sierpinskiArrowheadCurveFractals = drawFractalRow(paper2, TRIANGLE_ROW_COUNT, 4, getSierpinskiArrowheadCurve, baseFractalFunction);
}
var redrawSierpinskiArrowheadCurveFractalsButton = document.getElementById("sierpinski-arrowhead-curve-redraw-btn");
redrawSierpinskiArrowheadCurveFractalsButton.onclick = redrawSierpinskiArrowheadCurveFractals;
redrawSierpinskiArrowheadCurveFractals();



// draw one Pythagoras Tree
function handlePythagorasCanvas(containerElt, edgePathFunction) {
	let orderTextElt = containerElt.getElementsByClassName("level-text")[0];
	let redrawButtonElt = containerElt.getElementsByClassName("redraw-btn")[0];

	var paper = new Raphael(containerElt, "100%", 400);
	let canvasWidth = paper.canvas.clientWidth;
	let canvasHeight = paper.canvas.clientHeight;

	let maxOrder = 7;
	let sideLength = (5/3)*Math.min(canvasWidth, canvasHeight)/maxOrder;

	var pythagorasTreePathList = [];
	var centerPoint = {X: canvasWidth/2, Y: canvasHeight - (1/2)*sideLength};
	var orientation = (-1)*RADIANS_90_DEGREES;
	pythagorasTreeRoutine(maxOrder, pythagorasTreePathList, centerPoint, orientation, sideLength, edgePathFunction);

	// Update inner text of this element as the order/level being drawn grows
	let currentDrawOrder = 0;
	function drawPythagorasTreeCallback(order) {
		if (currentDrawOrder < order) {
			currentDrawOrder = order;
			orderTextElt.innerText = String(currentDrawOrder);
		}
	}
	// set up button for redrawing
	function redrawPythagorasTree() {
		paper.clear();
		currentDrawOrder = 0;
		drawPythagorasTree(paper, pythagorasTreePathList, 1000, drawPythagorasTreeCallback);
	}
	redrawButtonElt.onclick = redrawPythagorasTree;
	// draw the tree for the first time
	redrawPythagorasTree();
}

let containerElt3 = document.getElementById("canvas-3");
handlePythagorasCanvas(containerElt3);


// Draw a row of Pythagoras Trees
function drawPythagorasTreeMultiple(paper, edgePathFunctions, drawCallback) {
	// draw trees of this order
	let maxOrder = 7;

	let paperWidth = paper.canvas.clientWidth;
	let paperHeight = paper.canvas.clientHeight;

	let treeCount = edgePathFunctions.length;

	let treeSize = paperWidth/treeCount;
	let sideLength = treeSize/6;


	for (var i=0; i < edgePathFunctions.length; i++) {
		var pythagorasTreePathList = [];
		var centerPointX = (1/2)*treeSize + i*treeSize;
		var centerPointY = paperHeight - (1/2)*sideLength;

		var centerPoint = {X: centerPointX, Y: centerPointY};

		var orientation = (-1)*RADIANS_90_DEGREES;
		pythagorasTreeRoutine(maxOrder, pythagorasTreePathList, centerPoint, orientation, sideLength, edgePathFunctions[i]);
		drawPythagorasTree(paper, pythagorasTreePathList, 1000, drawCallback);
	}
}

let containerElt4 = document.getElementById("canvas-4");
let orderTextElt4 = containerElt4.getElementsByClassName("level-text")[0];
let redrawButtonElt4 = containerElt4.getElementsByClassName("redraw-btn")[0];

var paper4 = new Raphael(containerElt4, "100%", 250);

function redrawPythagorasTreeMultiple() {
	paper4.clear();
	let randomMultiplier = Math.random();
	let randomEdgePathFunction = function(fromPoint, toPoint, centerPoint) {
		return getCatmullRomPath(fromPoint, toPoint, centerPoint, randomMultiplier);
	};
	let edgePathFunctions = [getEllipsePath, getCurvedPath, randomEdgePathFunction];

	// update order text element as the order increments	
	let currentDrawOrder = 0;
	function drawPythagorasTreeCallback(order) {
		if (currentDrawOrder < order) {
			currentDrawOrder = order;
			orderTextElt4.innerText = String(currentDrawOrder);
		}
	}
	drawPythagorasTreeMultiple(paper4, edgePathFunctions, drawPythagorasTreeCallback);

}
redrawButtonElt4.onclick = redrawPythagorasTreeMultiple;
redrawPythagorasTreeMultiple();

</script>


<!-- Google analytics tracking code -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43101146-5', 'auto');
  ga('send', 'pageview');
</script>

</body>
